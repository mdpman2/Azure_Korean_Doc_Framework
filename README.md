# Azure Korean Document Understanding & Retrieval Framework

ì´ í”„ë¡œì íŠ¸ëŠ” Azure AI Services (Document Intelligence, OpenAI GPT-5.2)ë¥¼ í™œìš©í•˜ì—¬ í•œêµ­ì–´ ë¬¸ì„œë¥¼ ì •ë°€í•˜ê²Œ ë¶„ì„í•˜ê³ , RAG (Retrieval-Augmented Generation) ì‹œìŠ¤í…œì„ ìœ„í•œ ìµœì ì˜ ì²­í‚¹(Chunking) ë°ì´í„°ë¥¼ ìƒì„± ë° ê´€ë¦¬í•˜ëŠ” í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤.

> **ğŸ“¢ 2026-01 ì—…ë°ì´íŠ¸**: GPT-5.2, Structured Outputs, Query Rewrite, í–¥ìƒëœ Semantic Ranking ì§€ì›

## ğŸ†• v3.0 ì£¼ìš” ì—…ë°ì´íŠ¸ (2026-01)

| ì˜ì—­ | ì´ì „ ë²„ì „ | v3.0 ì—…ë°ì´íŠ¸ |
|------|----------|--------------|
| **LLM ëª¨ë¸** | GPT-4.1 | **GPT-5.2** via `model-router` (400K ì»¨í…ìŠ¤íŠ¸) |
| **API ë²„ì „** | 2024-08-01-preview | **2024-12-01-preview** (AI Foundry í˜¸í™˜) |
| **ë°°í¬ ë°©ì‹** | ì§ì ‘ ë°°í¬ | **model-router** (Azure AI Foundry) |
| **í† í° íŒŒë¼ë¯¸í„°** | max_tokens | **max_completion_tokens** (GPT-5.x) |
| **ê²€ìƒ‰ ê¸°ëŠ¥** | Hybrid Search | **Query Rewrite + Semantic Ranking L2** |
| **ì‘ë‹µ í˜•ì‹** | ì¼ë°˜ í…ìŠ¤íŠ¸ | **Structured Outputs** ì§€ì› |
| **ì¶”ë¡  ëª¨ë¸** | ë¯¸ì§€ì› | **reasoning_effort** íŒŒë¼ë¯¸í„° ì§€ì› |
| **í´ë¼ì´ì–¸íŠ¸** | ë¶„ë¦¬ (í‘œì¤€/ê³ ê¸‰) | **í†µí•© í´ë¼ì´ì–¸íŠ¸** (ë‹¨ì¼ ì—”ë“œí¬ì¸íŠ¸) |

## ğŸŒŸ í•µì‹¬ ê¸°ëŠ¥: Context-Rich Rolling Window

ë‹¨ìˆœí•œ í…ìŠ¤íŠ¸ ë¶„í• ì´ ì•„ë‹Œ, ë¬¸ì„œì˜ **êµ¬ì¡°(Hierarchy)**ì™€ **ë¬¸ë§¥(Context)**ì„ ë³´ì¡´í•˜ëŠ” **"Context-Rich Rolling Window"** ì „ëµì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

### ğŸ“„ ë¬¸ì„œ íŒŒì‹± (Parsing)

- **êµ¬ì¡°ì  í•˜ì´ë¸Œë¦¬ë“œ íŒŒì‹±**: Azure Document Intelligence Layout ëª¨ë¸(`prebuilt-layout`) v4.0 GA ì‚¬ìš©
- **ê³„ì¸µì  ë¬¸ë§¥ ì£¼ì…**: ëª¨ë“  ì²­í¬ì— Breadcrumb(ìƒìœ„ ëª©ì°¨ ê²½ë¡œ)ë¥¼ ìë™ìœ¼ë¡œ ì£¼ì…í•˜ì—¬ ê²€ìƒ‰ í’ˆì§ˆì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤.
- **í‘œ ë…ë¦½í™” (Table Isolation)**: í‘œ ë°ì´í„°ë¥¼ ë³„ë„ì˜ ì²­í¬ë¡œ ê²©ë¦¬í•˜ì—¬ Markdown í˜•ì‹ìœ¼ë¡œ êµ¬ì¡°ë¥¼ ìœ ì§€í•©ë‹ˆë‹¤.
- **í•œêµ­ì–´ íŠ¹í™” ì²­í‚¹**: `kss`ë¥¼ í™œìš©í•œ í•œêµ­ì–´ ë¬¸ì¥ ë¶„ë¦¬ ë° ì˜ë¯¸ ë‹¨ìœ„ ë¶„í• ì„ ì§€ì›í•©ë‹ˆë‹¤.
- **Visual RAG**: ë¬¸ì„œ ë‚´ ì´ë¯¸ì§€ë¥¼ **GPT-5.2 Vision**ìœ¼ë¡œ ë¶„ì„í•˜ì—¬ í…ìŠ¤íŠ¸ë¡œ í†µí•©í•©ë‹ˆë‹¤.

### ğŸ–¼ï¸ í–¥ìƒëœ ì´ë¯¸ì§€ ë¶„ì„ (v2.0)

- **ì´ë¯¸ì§€ ìœ í˜•ë³„ ë¶„ì„ ê°€ì´ë“œ**: UI ìŠ¤í¬ë¦°ìƒ·, í‘œ ì´ë¯¸ì§€, ë‹¤ì´ì–´ê·¸ë¨/ìˆœì„œë„, ì°¨íŠ¸/ê·¸ë˜í”„ ë“± ìœ í˜•ì— ë”°ë¥¸ ë§ì¶¤ ë¶„ì„
- **ë¬¸ë§¥ ê¸°ë°˜ ì´ë¯¸ì§€ ì„¤ëª…**: ì´ë¯¸ì§€ ì£¼ë³€ í…ìŠ¤íŠ¸ë¥¼ ë¶„ì„í•˜ì—¬ ë¬¸ì„œ ë§¥ë½ì— ë§ëŠ” ì„¤ëª… ìƒì„±
- **í•œêµ­ì–´ ìµœì í™”**: ëª¨ë“  ì´ë¯¸ì§€ ì„¤ëª…ì„ ìì—°ìŠ¤ëŸ¬ìš´ í•œêµ­ì–´ë¡œ ìƒì„±

### ğŸ“Š í–¥ìƒëœ í‘œ ì²˜ë¦¬ (v2.0)

- **í‘œ ì „ìš© ì²­í¬ ë¶„ë¦¬**: í‘œ ë°ì´í„°ë¥¼ ë…ë¦½ì ì¸ ì²­í¬ë¡œ ë¶„ë¦¬í•˜ì—¬ ê²€ìƒ‰ ì •í™•ë„ í–¥ìƒ
- **Markdown êµ¬ì¡° ë³´ì¡´**: í‘œì˜ í–‰/ì—´ êµ¬ì¡°ë¥¼ Markdown í…Œì´ë¸”ë¡œ ì •í™•í•˜ê²Œ ë³€í™˜
- **ë©”íƒ€ë°ì´í„° íƒœê¹…**: `is_table_data`, `contains_table` í”Œë˜ê·¸ë¡œ í‘œ ì½˜í…ì¸  ì‹ë³„

### ğŸ”¢ ë²ˆí˜¸ ëª©ë¡ ì²˜ë¦¬ (v2.0)

- **ì •ì±… ë¬¸ì„œ ìµœì í™”**: "06 ì œëª©" â†’ "### 06. ì œëª©" í˜•ì‹ìœ¼ë¡œ ìë™ ë³€í™˜
- **ê³„ì¸µ êµ¬ì¡° ì¸ì‹**: ë²ˆí˜¸ ê¸°ë°˜ ëª©ì°¨ ë° ì„¹ì…˜ êµ¬ì¡° ìë™ íŒŒì•…
- **ë©”íƒ€ë°ì´í„° íƒœê¹…**: `contains_numbered_section` í”Œë˜ê·¸ë¡œ ë²ˆí˜¸ ì„¹ì…˜ ì‹ë³„

## âš¡ ì£¼ìš” íŠ¹ì§•

- **ê³ ì„±ëŠ¥ ë³‘ë ¬ ì²˜ë¦¬**: ë‹¤ì¤‘ ì½”ì–´ë¥¼ í™œìš©í•˜ì—¬ ëŒ€ëŸ‰ì˜ ë¬¸ì„œë¥¼ ë¹ ë¥´ê²Œ ì¸ë±ì‹±í•©ë‹ˆë‹¤. (`--workers` ì˜µì…˜)
- **ë³€ê²½ ê°ì§€ ì¸ë±ì‹±**: íŒŒì¼ì˜ í•´ì‹œ(Hash)ë¥¼ ë¹„êµí•˜ì—¬ ë³€ê²½ëœ íŒŒì¼ë§Œ ì„ íƒì ìœ¼ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤.
- **ë©€í‹° ëª¨ë¸ í‰ê°€**: ë™ì¼í•œ ì§ˆë¬¸ì— ëŒ€í•´ ë‹¤ì–‘í•œ ëª¨ë¸(GPT-4.1, o1 ë“±)ì˜ ë‹µë³€ì„ ë¹„êµ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **ìœ í˜•ë³„ ì²­í¬ í†µê³„**: ì²˜ë¦¬ ì™„ë£Œ ì‹œ í…ìŠ¤íŠ¸/í‘œ/ì´ë¯¸ì§€ ì²­í¬ ìˆ˜ë¥¼ ë¶„ë¥˜í•˜ì—¬ í‘œì‹œí•©ë‹ˆë‹¤.

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        doc_chunk_main.py                        â”‚
â”‚                     (CLI í†µí•© ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Document Processing                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   parser.py     â”‚â”€â”€â”€â–¶â”‚   chunker.py    â”‚â”€â”€â”€â–¶â”‚ vector_storeâ”‚  â”‚
â”‚  â”‚ (Azure DI +     â”‚    â”‚ (Context-Rich   â”‚    â”‚    .py      â”‚  â”‚
â”‚  â”‚  GPT-5.2 Vision)â”‚    â”‚  Rolling Window)â”‚    â”‚(Azure Search)â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Q&A / RAG                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  â”‚    agent.py     â”‚â—€â”€â”€â”€â”‚  Azure AI Search â”‚                    â”‚
â”‚  â”‚  (Query Rewrite â”‚    â”‚  (Hybrid Search) â”‚                    â”‚
â”‚  â”‚  + RAG ë¡œì§)    â”‚    â”‚                  â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Azure AI Foundry (v3.0)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  â”‚  model-router   â”‚    â”‚  Unified Client â”‚                     â”‚
â”‚  â”‚  (GPT-5.2 ë¼ìš°íŒ…)â”‚â—€â”€â”€â”€â”‚  (ë‹¨ì¼ ì—”ë“œí¬ì¸íŠ¸)â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”„ ëª¨ë¸ ë¼ìš°íŒ… (v3.0)

```
ì‚¬ìš©ì ìš”ì²­ "gpt-5.2"
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   config.py       â”‚
â”‚   MODELS ë§¤í•‘     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼ gpt-5.2 â†’ model-router
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  model-router     â”‚
â”‚  (AI Foundry)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
   GPT-5.2 ì‘ë‹µ
```

## ğŸš€ ì‹œì‘í•˜ê¸°

### ì„¤ì¹˜

```bash
pip install openai azure-ai-documentintelligence azure-search-documents \
    pymupdf pillow python-dotenv tiktoken kss
```

### í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (.env)

```env
# Azure AI Foundry ì—”ë“œí¬ì¸íŠ¸ (GPT-5.2 via model-router)
# âš ï¸ GPT-5.xëŠ” ì§ì ‘ ë°°í¬ê°€ ì•„ë‹Œ model-routerë¥¼ í†µí•´ ì ‘ê·¼í•©ë‹ˆë‹¤
OPEN_AI_KEY_5=your_foundry_api_key
OPEN_AI_ENDPOINT_5=https://your-resource.cognitiveservices.azure.com/

# API ë²„ì „ (2024-12-01-preview ê¶Œì¥, 2025-01-01-previewëŠ” ì¼ë¶€ ì—”ë“œí¬ì¸íŠ¸ì—ì„œ ë¯¸ì§€ì›)
AZURE_OPENAI_API_VERSION=2024-12-01-preview

# ê¸°ë³¸ ëª¨ë¸ ì„¤ì •
DEFAULT_MODEL=gpt-5.2          # ê¸°ë³¸ ë‹µë³€ ëª¨ë¸ (â†’ model-routerë¡œ ë¼ìš°íŒ…)
VISION_MODEL=gpt-5.2           # ì´ë¯¸ì§€ ë¶„ì„ ëª¨ë¸
PARSING_MODEL=gpt-5.2          # ë¬¸ì„œ íŒŒì‹± ëª¨ë¸

# Azure Document Intelligence (v4.0 GA: 2024-11-30)
AZURE_DI_ENDPOINT=https://your-resource.cognitiveservices.azure.com/
AZURE_DI_KEY=your_doc_intel_key

# Azure AI Search
AZURE_SEARCH_ENDPOINT=https://your-search.search.windows.net
AZURE_SEARCH_INDEX_NAME=your-index-name
AZURE_SEARCH_KEY=your_search_api_key

# ì„ë² ë”© ì„¤ì •
AZURE_OPENAI_EMBEDDING_DEPLOYMENT=text-embedding-3-small
EMBEDDING_DIMENSIONS=1536
```

## ğŸ›  ì‚¬ìš© ë°©ë²•

### 1. ë¬¸ì„œ ì¸ë±ì‹± (Ingestion)

```bash
# ë””ë ‰í† ë¦¬ ë‚´ ëª¨ë“  PDF ì²˜ë¦¬ (ê¸°ë³¸ 3ê°œ ë³‘ë ¬ ì‘ì—…)
python doc_chunk_main.py --path "RAG_TEST_DATA"

# íŠ¹ì • íŒŒì¼ë§Œ ì²˜ë¦¬ ë° ë³‘ë ¬ ì‘ì—… ìˆ˜ ì§€ì •
python doc_chunk_main.py --path "data/sample.pdf" --workers 5

# Q&A ì—†ì´ ì¸ë±ì‹±ë§Œ ìˆ˜í–‰
python doc_chunk_main.py --path "data/sample.pdf" --skip-qa
```

### 2. Q&A í…ŒìŠ¤íŠ¸ ë° ëª¨ë¸ ë¹„êµ

```bash
# ì¸ë±ì‹± í›„ ë°”ë¡œ í…ŒìŠ¤íŠ¸ (ê¸°ë³¸ ì§ˆë¬¸ ì‚¬ìš©)
python doc_chunk_main.py --path "RAG_TEST_DATA"

# ì¸ë±ì‹± ì—†ì´ íŠ¹ì • ì§ˆë¬¸ìœ¼ë¡œ í…ŒìŠ¤íŠ¸
python doc_chunk_main.py --skip-ingest --question "ì˜¬í•´ì˜ ê²½ì œ ì „ë§ì€?"

# íŠ¹ì • ëª¨ë¸ë¡œ í…ŒìŠ¤íŠ¸
python doc_chunk_main.py --skip-ingest --question "ëŠ˜ë´„í•™êµë€?" --model "gpt-4.1"
```

### 3. ì¶œë ¥ ì˜ˆì‹œ

```
âœ… ì²˜ë¦¬ ì™„ë£Œ
   â””â”€â”€ ì´ ì„¸ê·¸ë¨¼íŠ¸: 66ê°œ
   â””â”€â”€ ìƒì„±ëœ ì²­í¬: 30ê°œ
       â”œâ”€â”€ í…ìŠ¤íŠ¸: 23ê°œ
       â”œâ”€â”€ í‘œ: 5ê°œ
       â””â”€â”€ ì´ë¯¸ì§€: 2ê°œ
```

## ğŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
azure_korean_doc_framework1/
â”œâ”€â”€ azure_korean_doc_framework/
â”‚   â”œâ”€â”€ parsing/
â”‚   â”‚   â”œâ”€â”€ parser.py       # Azure DI + GPT-5.2 Vision í•˜ì´ë¸Œë¦¬ë“œ íŒŒì‹±
â”‚   â”‚   â””â”€â”€ chunker.py      # Context-Rich Rolling Window ì²­í‚¹
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ vector_store.py # Azure AI Search ì¸ë±ì‹±/ê²€ìƒ‰
â”‚   â”‚   â””â”€â”€ agent.py        # RAG ì§ˆì˜ì‘ë‹µ ë¡œì§
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ logger.py       # ì²­í¬ ë¡œê·¸ ì €ì¥
â”‚   â”‚   â””â”€â”€ azure_clients.py # Azure í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”
â”‚   â””â”€â”€ config.py           # í™˜ê²½ ë³€ìˆ˜ ê²€ì¦ ë° ëª¨ë¸ êµ¬ì„±
â”œâ”€â”€ doc_chunk_main.py       # í†µí•© ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸ (CLI)
â”œâ”€â”€ doc_chunk_main_only_q.py # Q&A ì „ìš© ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ verify_index.py         # ì¸ë±ìŠ¤ ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ test_framework.py       # v3.0 í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸ (5ê°œ ëª¨ë“ˆ)
â”œâ”€â”€ output/                 # ì²­í¬ ë¡œê·¸ ì¶œë ¥ í´ë”
â”œâ”€â”€ .env                    # í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
â””â”€â”€ README.md
```

## ğŸ”§ í•µì‹¬ ëª¨ë“ˆ ì„¤ëª…

### parser.py (ë¬¸ì„œ ë¶„ì„) - v3.0 ì—…ë°ì´íŠ¸

| í•¨ìˆ˜ | ì„¤ëª… |
|------|------|
| `parse_pdf()` | PDFë¥¼ Azure DI v4.0ìœ¼ë¡œ ë¶„ì„í•˜ì—¬ êµ¬ì¡°í™”ëœ ì„¸ê·¸ë¨¼íŠ¸ ì¶”ì¶œ |
| `_describe_image()` | **GPT-5.2 Vision** (model-router)ìœ¼ë¡œ ì´ë¯¸ì§€ ë¶„ì„ |
| `_extract_context_around_offset()` | ì´ë¯¸ì§€ ì£¼ë³€ í…ìŠ¤íŠ¸ ì¶”ì¶œë¡œ ë¬¸ë§¥ íŒŒì•… |
| `_enhance_numbered_content()` | ë²ˆí˜¸ ëª©ë¡ í˜•ì‹ ì •ê·œí™” ("06 ì œëª©" â†’ "### 06. ì œëª©") |
| `is_gpt5` ê°ì§€ | GPT-5.xë©´ `max_completion_tokens` ì‚¬ìš© |

### agent.py (RAG ì—ì´ì „íŠ¸) - v3.0 ì—…ë°ì´íŠ¸

| í•¨ìˆ˜ | ì„¤ëª… |
|------|------|
| `answer_question()` | **GPT-5.2** ê¸°ë°˜ RAG ì§ˆì˜ì‘ë‹µ (model-router ë¼ìš°íŒ…) |
| `_rewrite_query()` | **Query Rewrite** - ì˜ë¯¸ì  ì¿¼ë¦¬ í™•ì¥ (ì˜¤íƒ€ êµì •, ë™ì˜ì–´) |
| `use_query_rewrite` | Query Rewrite í™œì„±í™” ì˜µì…˜ (ê¸°ë³¸: True) |

### multi_model_manager.py (ëª¨ë¸ ê´€ë¦¬) - v3.0 ì—…ë°ì´íŠ¸

| í•¨ìˆ˜ | ì„¤ëª… |
|------|------|
| `get_completion()` | GPT-5.xìš© **max_completion_tokens**, **reasoning_effort** ì§€ì› |
| `get_structured_completion()` | **Structured Outputs** JSON ìŠ¤í‚¤ë§ˆ ì‘ë‹µ |
| `is_gpt5_series()` | GPT-5.x ì‹œë¦¬ì¦ˆ ê°ì§€ (gpt-5, gpt-5.1, gpt-5.2) |

### azure_clients.py (í´ë¼ì´ì–¸íŠ¸ íŒ©í† ë¦¬) - v3.0.1 ì‹ ê·œ

| í•¨ìˆ˜ | ì„¤ëª… |
|------|------|
| `get_openai_client()` | **í†µí•© í´ë¼ì´ì–¸íŠ¸** - ë‹¨ì¼ ì—”ë“œí¬ì¸íŠ¸ë¡œ ëª¨ë“  ìš”ì²­ ì²˜ë¦¬ |
| `get_document_intelligence_client()` | Azure DI v4.0 í´ë¼ì´ì–¸íŠ¸ (ìºì‹±) |
| `get_search_client()` | Azure AI Search í´ë¼ì´ì–¸íŠ¸ (ìºì‹±) |

### config.py (ì„¤ì •) - v3.0.1 ì—…ë°ì´íŠ¸

| ì„¤ì • | ì„¤ëª… |
|------|------|
| `MODELS` | ëª¨ë¸ëª… â†’ ë°°í¬ëª… ë§¤í•‘ (`gpt-5.2` â†’ `model-router`) |
| `ADVANCED_MODELS` | **frozenset** - O(1) ê³ ì„±ëŠ¥ ëª¨ë¸ ì¡°íšŒ |
| `REASONING_MODELS` | **frozenset** - O(1) ì¶”ë¡  ëª¨ë¸ ì¡°íšŒ |

### vector_store.py (ë²¡í„° ì €ì¥ì†Œ)

| í•¨ìˆ˜ | ì„¤ëª… |
|------|------|
| `upload_documents()` | ì²­í¬ë¥¼ Azure AI Searchì— ì—…ë¡œë“œ |
| `hybrid_search()` | í‚¤ì›Œë“œ + ë²¡í„° í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ + **Semantic Ranking L2** |
| `ensure_index_exists()` | ì¸ë±ìŠ¤ ìë™ ìƒì„±/ê²€ì¦ |

## ğŸ“ˆ ì²­í¬ ë©”íƒ€ë°ì´í„°

ê° ì²­í¬ì—ëŠ” ë‹¤ìŒ ë©”íƒ€ë°ì´í„°ê°€ í¬í•¨ë©ë‹ˆë‹¤:

| í•„ë“œ | ì„¤ëª… |
|------|------|
| `chunk_type` | ì²­í¬ ìœ í˜• (text, table, image) |
| `breadcrumb` | ìƒìœ„ ì„¹ì…˜ ê²½ë¡œ (ì˜ˆ: "1ì¥ > 1.1ì ˆ") |
| `source_file` | ì›ë³¸ íŒŒì¼ëª… |
| `page_number` | í˜ì´ì§€ ë²ˆí˜¸ |
| `is_table_data` | í‘œ ë°ì´í„° ì—¬ë¶€ |
| `is_image_data` | ì´ë¯¸ì§€ ì„¤ëª… ì—¬ë¶€ |
| `contains_numbered_section` | ë²ˆí˜¸ ì„¹ì…˜ í¬í•¨ ì—¬ë¶€ |

## ğŸ§ª í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì˜ˆì‹œ

**ì§ˆë¬¸**: "ëŠ˜ë´„í•™êµë€ ë¬´ì—‡ì´ê³  ì–¸ì œë¶€í„° ì „êµ­ ë„ì…ë˜ë‚˜ìš”?"

**ë‹µë³€** (ë¬¸ì„œ ê¸°ë°˜):
> ëŠ˜ë´„í•™êµëŠ” ì´ˆë“±í•™êµì—ì„œ ì •ê·œìˆ˜ì—… ì™¸ì— ë‹¤ì–‘í•œ êµìœ¡ ë° ëŒë´„ í”„ë¡œê·¸ë¨ì„ ì œê³µí•˜ëŠ” ì¢…í•© ëŒë´„ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.
> - **2024ë…„ 1í•™ê¸°**: 2,000ê°œêµì—ì„œ ì‹œë²” ìš´ì˜
> - **2024ë…„ 2í•™ê¸°**: ì „êµ­ ëª¨ë“  ì´ˆë“±í•™êµë¡œ í™•ëŒ€
> - **2025ë…„**: ì „ í•™ë…„ í™•ëŒ€ ë° ë‚´ì‹¤í™”
>
> ğŸ“š ì¶œì²˜: [2024ë…„ êµìœ¡ë¶€ ì—…ë¬´ê³„íš.pdf]

## ğŸ“‹ ìš”êµ¬ì‚¬í•­

- Python 3.9+
- Azure êµ¬ë… ë° ë‹¤ìŒ ì„œë¹„ìŠ¤:
  - **Azure AI Foundry** (GPT-5.2 via model-router, text-embedding-3-small)
    - API ë²„ì „: `2024-12-01-preview`
  - **Azure Document Intelligence** v4.0 GA (2024-11-30)
  - **Azure AI Search** (Semantic Ranking í™œì„±í™” ê¶Œì¥)

### ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹¤í–‰

```bash
# ì „ì²´ ëª¨ë“ˆ í…ŒìŠ¤íŠ¸ (5ê°œ ëª¨ë“ˆ)
python test_framework.py

# Q&A í†µí•© í…ŒìŠ¤íŠ¸
python doc_chunk_main_only_q.py --question "í…ŒìŠ¤íŠ¸ ì§ˆë¬¸" --model "gpt-5.2"
```

## ğŸ”„ ë³€ê²½ ì´ë ¥

### v3.0.1 (2026-01-26) - ìµœì‹ 
- âœ… **model-router ë°°í¬ ë°©ì‹** ì§€ì› (Azure AI Foundry)
  - GPT-5.xëŠ” ì§ì ‘ ë°°í¬ê°€ ì•„ë‹Œ `model-router`ë¥¼ í†µí•´ ì ‘ê·¼
  - `config.py`ì—ì„œ ìë™ ë¼ìš°íŒ…: `gpt-5.2` â†’ `model-router`
- âœ… **í†µí•© í´ë¼ì´ì–¸íŠ¸** ì•„í‚¤í…ì²˜
  - í‘œì¤€/ê³ ê¸‰ í´ë¼ì´ì–¸íŠ¸ ë¶„ë¦¬ ì œê±°
  - ë‹¨ì¼ ì—”ë“œí¬ì¸íŠ¸ë¡œ ëª¨ë“  ìš”ì²­ ì²˜ë¦¬ (ì¸ì¦ ê°„ì†Œí™”)
- âœ… **API ë²„ì „ ìˆ˜ì •**: `2024-12-01-preview` (í˜¸í™˜ì„± ê°œì„ )
- âœ… **frozenset ìµœì í™”**: `ADVANCED_MODELS`, `REASONING_MODELS`
  - ëª¨ë¸ ì¡°íšŒ O(1) ì„±ëŠ¥ ë³´ì¥
- âœ… **test_framework.py** ì¶”ê°€
  - 5ê°œ ëª¨ë“ˆ ìë™ í…ŒìŠ¤íŠ¸ (Config, Clients, Manager, Parser, Agent)
  - GPT-5.2 API ì—°ê²° í…ŒìŠ¤íŠ¸ í¬í•¨

### v3.0 (2026-01-25)
- âœ… **GPT-5.2** ê¸°ë³¸ ëª¨ë¸ë¡œ ì „í™˜ (Vision + Reasoning í†µí•©)
- âœ… **max_completion_tokens** íŒŒë¼ë¯¸í„° ì§€ì› (GPT-5.x ì „ìš©)
- âœ… **Structured Outputs** ì§€ì› (`get_structured_completion()`)
- âœ… **Query Rewrite** ê¸°ëŠ¥ ì¶”ê°€ (ì˜ë¯¸ì  ì¿¼ë¦¬ í™•ì¥)
- âœ… **reasoning_effort** íŒŒë¼ë¯¸í„° ì§€ì› (low/medium/high)
- âœ… ê³ ì„±ëŠ¥ ëª¨ë¸ ëª©ë¡ í™•ì¥ (o3, o4-mini ì¶”ê°€)

### v2.0
- ì´ë¯¸ì§€ ìœ í˜•ë³„ ë¶„ì„ ê°€ì´ë“œ
- í‘œ ì „ìš© ì²­í¬ ë¶„ë¦¬
- ë²ˆí˜¸ ëª©ë¡ ì²˜ë¦¬ ê°œì„ 

## ğŸ“œ ë¼ì´ì„ ìŠ¤

MIT License

## ğŸ”— ê´€ë ¨ í”„ë¡œì íŠ¸

- [Korean_Doc_Chunking_Azure](../Korean_Doc_Chunking_Azure) - ì´ì „ ë²„ì „
- [azure_search_foundry_agent.py](../azure_search_foundry_agent.py) - Foundry Agent í†µí•© ë²„ì „
- [advanced_text_to_sql](../advanced_text_to_sql) - GPT-5.2 Text-to-SQL ì—ì´ì „íŠ¸
